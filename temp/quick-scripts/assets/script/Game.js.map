{"version":3,"sources":["Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Game extends cc.Component {\n    @property({type:cc.Prefab})\n    startPerFab:any = null;\n    @property({type:cc.Node})\n    ground:any = null;\n    @property({type:cc.Node})\n    player:any = null;\n    @property({type:cc.Node})\n    gameOverNode:any = null;\n    @property({type:cc.Label})\n    scorePlay:any = null;\n    @property({type:cc.AudioClip})\n    scoreAuio\n    @property({type:cc.Node})\n    btnStart\n    @property\n    groundY:number = 0;\n    @property\n    groundX:number = 0;\n    @property\n    score:number = 0;\n    @property\n    maxStart:number = 0;\n    @property\n    minStart:number = 0;\n    @property\n    timer:any = 0;\n    @property\n    startDura:any = 0;\n    @property\n    currentStart\n\n\n\n\n    // LIFE-CYCLE CALLBACKS:\n\n    public onLoad () {\n        //记录星星显示的有效时长\n        this.timer = 0;\n        //记录星星是显示时长\n        this.startDura = 0;\n\n        //获取地平面的高度\n        this.groundY = this.ground.y + this.ground.height/2\n        // //随机生星星\n        // this.newStart();\n\n        this.score = 0;\n        this.enabled = false;\n\n        //\n        this.currentStart = null;\n\n    }\n\n    public update (dt) {\n        if(this.timer > this.startDura){\n            this.gameOver();\n            return;\n        }\n        this.timer += dt;\n    }\n    public gameOver(){\n        this.enabled = false;\n        this.player.getComponent('Play').enabled = false;\n        this.player.stopAllActions();\n        this.btnStart.x = 0;\n        this.currentStart.destroy();\n        //激活节点\n        this.gameOverNode.active = true;\n    }\n    public onStartGame(){\n       this.resetScore();\n       this.enabled = true;\n       //隐藏按钮\n       this.btnStart.x = 1000;\n       //小怪兽初始化\n       this.player.getComponent('Play').init(cc.v2(0,this.groundY))\n      //随机生星星\n      this.newStart();\n      //关闭节点\n      this.gameOverNode.active = false;\n\n    }\n    public resetScore(){\n        this.score = 0;\n        this.scorePlay.string = \"Score:\"+this.score;\n    }\n    public newStart(){\n        let newStart = cc.instantiate(this.startPerFab);\n        this.node.addChild(newStart);\n        //将game引入注入到start\n        // newStart.getComponent('Start').game = this;\n        newStart.getComponent('Start').init(this);\n\n        newStart.setPosition(this.getNewStartPosition())\n        \n        //保存当前星星的饮用\n        this.currentStart = newStart;\n\n        this.startDura = this.minStart + Math.random()*(this.maxStart - this.minStart);\n        this.timer = 0;\n\n    }\n\n    public getNewStartPosition(){\n        let randY = this.groundY + Math.random()*this.player.getComponent('Play').jumpHeight+30;\n        let max = this.node.width/2 ;\n        let randX = (Math.random()-0.5) * 2*max;\n        return cc.v2(randX,randY)\n    }\n    //获取分数\n    public gainScore(){\n        this.score +=1\n        console.log(this.scorePlay)\n        this.scorePlay.string = \"Score:\" + this.score.toString();\n        cc.audioEngine.playEffect(this.scoreAuio,false)\n\n    }\n}\n"]}